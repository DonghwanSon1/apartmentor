<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="visitCarMapper">

	
	<select id="selectVisitCar" resultType="_int">
		SELECT COUNT(*) 
		  FROM PARKING 
		 WHERE CAR_NO = #{carNo}
	</select>

	<insert id="enrollVisitCar" parameterType="parking">
		INSERT
		  INTO
		  	   PARKING
		  	   (
		  	   CAR_NO,
		  	   CAR_PHONE,
		  	   STATUS,
		  	   CAR_CATEGORY,
		  	   CAR_DATE,
		  	   CAR_PURPOSE,
		  	   USER_NO
		  	   )
		VALUES
				(
				#{carNo},
				#{carPhone},
				'N',
				#{carCategory},
				#{carDate},
				#{carPurpose},
				#{userNo}
				)
	</insert>
	
	<update id="updateVisitCar" parameterType="parking">
		UPDATE 
			   PARKING
  		   SET 
  		       CAR_PHONE = #{carPhone},
     	       STATUS = 'N',
  	           CAR_CATEGORY = #{carCategory},
  	           CAR_DATE = #{carDate},
   		       CAR_PURPOSE = #{carPurpose},
   		       USER_NO = #{userNo}
		 WHERE 
		       CAR_NO = #{carNo}
	</update>
	
	<update id="setDayVisitCar">
		UPDATE PARKING
	  	   SET STATUS = CASE
	   	  WHEN CAR_DATE = TO_CHAR(SYSDATE, 'YYYY-MM-DD')
	   	  THEN 'Y'
	   	  ELSE 'N'
	       END
	</update>

</mapper>
